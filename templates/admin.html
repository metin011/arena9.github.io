{% extends "base.html" %}

{% block title %}Admin Panel{% endblock %}

{% block extra_css %}
<style>
    .admin-header {
        text-align: center;
        color: white;
        margin-bottom: 2rem;
    }

    .admin-title {
        font-size: 2.5rem;
        margin-bottom: 0.5rem;
    }

    .admin-subtitle {
        font-size: 1.1rem;
        opacity: 0.9;
    }

    .tabs {
        display: flex;
        gap: 1rem;
        margin-bottom: 2rem;
        background: white;
        padding: 1rem;
        border-radius: 15px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .tab-btn {
        flex: 1;
        padding: 1rem;
        border: none;
        background: #ecf0f1;
        border-radius: 10px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
    }

    .tab-btn.active {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }

    .tab-content {
        display: none;
    }

    .tab-content.active {
        display: block;
    }

    .section-card {
        background: white;
        border-radius: 15px;
        padding: 2rem;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        margin-bottom: 2rem;
    }

    .section-title {
        font-size: 1.5rem;
        margin-bottom: 1.5rem;
        color: #2c3e50;
        border-bottom: 3px solid #667eea;
        padding-bottom: 0.5rem;
    }

    .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
        margin-bottom: 1.5rem;
    }

    .form-group {
        margin-bottom: 1rem;
    }

    .form-label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 600;
        color: #333;
    }

    .form-input, .form-select {
        width: 100%;
        padding: 0.7rem;
        border: 2px solid #ecf0f1;
        border-radius: 8px;
        font-size: 0.95rem;
        transition: border-color 0.3s;
    }

    .form-input:focus, .form-select:focus {
        outline: none;
        border-color: #667eea;
    }

    .btn-add {
        background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        color: white;
        padding: 0.8rem 2rem;
        border: none;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.3s;
    }

    .btn-add:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
    }

    .data-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1rem;
    }

    .data-table th {
        background: #f8f9fa;
        padding: 1rem;
        text-align: left;
        font-weight: 600;
        color: #2c3e50;
        border-bottom: 2px solid #ecf0f1;
    }

    .data-table td {
        padding: 1rem;
        border-bottom: 1px solid #ecf0f1;
    }

    .data-table tr:hover {
        background: #f8f9fa;
    }

    .btn-edit, .btn-delete {
        padding: 0.4rem 1rem;
        border: none;
        border-radius: 5px;
        font-size: 0.85rem;
        cursor: pointer;
        margin-right: 0.5rem;
        transition: all 0.3s;
    }

    .btn-edit {
        background: #3498db;
        color: white;
    }

    .btn-edit:hover {
        background: #2980b9;
    }

    .btn-delete {
        background: #e74c3c;
        color: white;
    }

    .btn-delete:hover {
        background: #c0392b;
    }

    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 3000;
        align-items: center;
        justify-content: center;
    }

    .modal.active {
        display: flex;
    }

    .modal-content {
        background: white;
        border-radius: 15px;
        padding: 2rem;
        max-width: 600px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
    }

    .modal-header {
        font-size: 1.5rem;
        margin-bottom: 1.5rem;
        color: #2c3e50;
    }

    .modal-close {
        float: right;
        font-size: 1.5rem;
        cursor: pointer;
        color: #95a5a6;
    }

    .modal-close:hover {
        color: #e74c3c;
    }

    .status-badge {
        padding: 0.3rem 0.8rem;
        border-radius: 15px;
        font-size: 0.8rem;
        font-weight: 600;
    }

    .badge-scheduled {
        background: #3498db;
        color: white;
    }

    .badge-live {
        background: #e74c3c;
        color: white;
    }

    .badge-finished {
        background: #95a5a6;
        color: white;
    }

    .badge-admin {
        background: #f39c12;
        color: white;
    }

    .badge-user {
        background: #3498db;
        color: white;
    }
</style>
{% endblock %}

{% block content %}
<div class="admin-header">
    <h1 class="admin-title">üõ†Ô∏è Admin Panel</h1>
    <p class="admin-subtitle">Ma√ßlarƒ±, oyuncularƒ± ve kullanƒ±cƒ±larƒ± y√∂netin</p>
</div>

<div class="tabs">
    <button class="tab-btn active" onclick="switchTab('matches')">‚öΩ Ma√ßlar</button>
    <button class="tab-btn" onclick="switchTab('players')">üë• Oyuncular</button>
    <button class="tab-btn" onclick="switchTab('users')">üë§ Kullanƒ±cƒ±lar</button>
</div>

<!-- Matches Tab -->
<div id="matches-tab" class="tab-content active">
    <div class="section-card">
        <h2 class="section-title">Yeni Ma√ß Ekle</h2>
        <form method="POST" action="{{ url_for('add_match') }}">
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">Ev Sahibi Takƒ±m</label>
                    <input type="text" name="home_team" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Deplasman Takƒ±mƒ±</label>
                    <input type="text" name="away_team" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Ev Sahibi Skor</label>
                    <input type="number" name="home_score" class="form-input" value="0" min="0">
                </div>
                <div class="form-group">
                    <label class="form-label">Deplasman Skor</label>
                    <input type="number" name="away_score" class="form-input" value="0" min="0">
                </div>
                <div class="form-group">
                    <label class="form-label">Ma√ß Tarihi</label>
                    <input type="datetime-local" name="match_date" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Stadyum</label>
                    <input type="text" name="stadium" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">Durum</label>
                    <select name="status" class="form-select">
                        <option value="scheduled">Planlandƒ±</option>
                        <option value="live">Canlƒ±</option>
                        <option value="finished">Bitti</option>
                    </select>
                </div>
            </div>
            <button type="submit" class="btn-add">‚ûï Ma√ß Ekle</button>
        </form>
    </div>

    <div class="section-card">
        <h2 class="section-title">T√ºm Ma√ßlar</h2>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Tarih</th>
                    <th>Ev Sahibi</th>
                    <th>Skor</th>
                    <th>Deplasman</th>
                    <th>Stadyum</th>
                    <th>Durum</th>
                    <th>ƒ∞≈ülemler</th>
                </tr>
            </thead>
            <tbody>
                {% for match in matches %}
                <tr>
                    <td>{{ match.match_date.strftime('%d.%m.%Y %H:%M') }}</td>
                    <td>{{ match.home_team }}</td>
                    <td><strong>{{ match.home_score }} - {{ match.away_score }}</strong></td>
                    <td>{{ match.away_team }}</td>
                    <td>{{ match.stadium or '-' }}</td>
                    <td>
                        <span class="status-badge badge-{{ match.status }}">
                            {% if match.status == 'scheduled' %}Planlandƒ±
                            {% elif match.status == 'live' %}Canlƒ±
                            {% else %}Bitti{% endif %}
                        </span>
                    </td>
                    <td>
                        <button class="btn-edit" onclick="editMatch({{ match.id }}, '{{ match.home_team }}', '{{ match.away_team }}', {{ match.home_score }}, {{ match.away_score }}, '{{ match.match_date.strftime('%Y-%m-%dT%H:%M') }}', '{{ match.stadium }}', '{{ match.status }}')">‚úèÔ∏è D√ºzenle</button>
                        <form method="POST" action="{{ url_for('delete_match', match_id=match.id) }}" style="display:inline;" onsubmit="return confirm('Bu ma√ßƒ± silmek istediƒüinizden emin misiniz?');">
                            <button type="submit" class="btn-delete">üóëÔ∏è Sil</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Players Tab -->
<div id="players-tab" class="tab-content">
    <div class="section-card">
        <h2 class="section-title">Yeni Oyuncu Ekle</h2>
        <p style="margin-bottom: 1rem; color: #666;">Detaylƒ± oyuncu bilgileri eklemek i√ßin a≈üaƒüƒ±daki butona tƒ±klayƒ±n.</p>
        <a href="{{ url_for('admin_add_player') }}" class="btn-add" style="display: inline-block; text-decoration: none; text-align: center;">‚ûï Yeni Oyuncu Ekle</a>
    </div>

    <div class="section-card">
        <h2 class="section-title">T√ºm Oyuncular</h2>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Oyuncu</th>
                    <th>Pozisyon</th>
                    <th>Takƒ±m</th>
                    <th>Goller</th>
                    <th>Asistler</th>
                    <th>Ma√ßlar</th>
                    <th>ƒ∞≈ülemler</th>
                </tr>
            </thead>
            <tbody>
                {% for player in players %}
                <tr>
                    <td><strong>{{ player.name }}</strong></td>
                    <td>{{ player.position }}</td>
                    <td>{{ player.team }}</td>
                    <td>{{ player.goals }}</td>
                    <td>{{ player.assists }}</td>
                    <td>{{ player.matches_played }}</td>
                    <td>
                        <button class="btn-edit" onclick="editPlayer({{ player.id }}, '{{ player.name }}', '{{ player.position }}', '{{ player.team }}', {{ player.goals }}, {{ player.assists }}, {{ player.matches_played }})">‚úèÔ∏è D√ºzenle</button>
                        <form method="POST" action="{{ url_for('delete_player', player_id=player.id) }}" style="display:inline;" onsubmit="return confirm('Bu oyuncuyu silmek istediƒüinizden emin misiniz?');">
                            <button type="submit" class="btn-delete">üóëÔ∏è Sil</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Users Tab -->
<div id="users-tab" class="tab-content">
    <div class="section-card">
        <h2 class="section-title">Kullanƒ±cƒ±lar</h2>
        <table class="data-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Kullanƒ±cƒ± Adƒ±</th>
                    <th>Rol</th>
                    <th>Kayƒ±t Tarihi</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr>
                    <td>{{ user.id }}</td>
                    <td><strong>{{ user.username }}</strong></td>
                    <td>
                        <span class="status-badge {% if user.is_admin %}badge-admin{% else %}badge-user{% endif %}">
                            {% if user.is_admin %}Admin{% else %}Kullanƒ±cƒ±{% endif %}
                        </span>
                    </td>
                    <td>{{ user.created_at.strftime('%d.%m.%Y %H:%M') }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Edit Match Modal -->
<div id="editMatchModal" class="modal">
    <div class="modal-content">
        <span class="modal-close" onclick="closeModal('editMatchModal')">&times;</span>
        <h2 class="modal-header">Ma√ß D√ºzenle</h2>
        <form id="editMatchForm" method="POST">
            <div class="form-group">
                <label class="form-label">Ev Sahibi Takƒ±m</label>
                <input type="text" name="home_team" id="edit_home_team" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Deplasman Takƒ±mƒ±</label>
                <input type="text" name="away_team" id="edit_away_team" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Ev Sahibi Skor</label>
                <input type="number" name="home_score" id="edit_home_score" class="form-input" min="0">
            </div>
            <div class="form-group">
                <label class="form-label">Deplasman Skor</label>
                <input type="number" name="away_score" id="edit_away_score" class="form-input" min="0">
            </div>
            <div class="form-group">
                <label class="form-label">Ma√ß Tarihi</label>
                <input type="datetime-local" name="match_date" id="edit_match_date" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Stadyum</label>
                <input type="text" name="stadium" id="edit_stadium" class="form-input">
            </div>
            <div class="form-group">
                <label class="form-label">Durum</label>
                <select name="status" id="edit_status" class="form-select">
                    <option value="scheduled">Planlandƒ±</option>
                    <option value="live">Canlƒ±</option>
                    <option value="finished">Bitti</option>
                </select>
            </div>
            <button type="submit" class="btn-add">üíæ Kaydet</button>
        </form>
    </div>
</div>

<!-- Edit Player Modal -->
<div id="editPlayerModal" class="modal">
    <div class="modal-content">
        <span class="modal-close" onclick="closeModal('editPlayerModal')">&times;</span>
        <h2 class="modal-header">Oyuncu D√ºzenle</h2>
        <form id="editPlayerForm" method="POST">
            <div class="form-group">
                <label class="form-label">Oyuncu Adƒ±</label>
                <input type="text" name="name" id="edit_player_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Pozisyon</label>
                <input type="text" name="position" id="edit_player_position" class="form-input">
            </div>
            <div class="form-group">
                <label class="form-label">Takƒ±m</label>
                <input type="text" name="team" id="edit_player_team" class="form-input">
            </div>
            <div class="form-group">
                <label class="form-label">Goller</label>
                <input type="number" name="goals" id="edit_player_goals" class="form-input" min="0">
            </div>
            <div class="form-group">
                <label class="form-label">Asistler</label>
                <input type="number" name="assists" id="edit_player_assists" class="form-input" min="0">
            </div>
            <div class="form-group">
                <label class="form-label">Oynanan Ma√ßlar</label>
                <input type="number" name="matches_played" id="edit_player_matches" class="form-input" min="0">
            </div>
            <button type="submit" class="btn-add">üíæ Kaydet</button>
        </form>
    </div>
</div>

<script>
    function switchTab(tabName) {
        // Hide all tabs
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.classList.remove('active');
        });

        // Show selected tab
        document.getElementById(tabName + '-tab').classList.add('active');
        event.target.classList.add('active');
    }

    function editMatch(id, homeTeam, awayTeam, homeScore, awayScore, matchDate, stadium, status) {
        document.getElementById('edit_home_team').value = homeTeam;
        document.getElementById('edit_away_team').value = awayTeam;
        document.getElementById('edit_home_score').value = homeScore;
        document.getElementById('edit_away_score').value = awayScore;
        document.getElementById('edit_match_date').value = matchDate;
        document.getElementById('edit_stadium').value = stadium;
        document.getElementById('edit_status').value = status;
        document.getElementById('editMatchForm').action = '/admin/match/edit/' + id;
        document.getElementById('editMatchModal').classList.add('active');
    }

    function editPlayer(id, name, position, team, goals, assists, matches) {
        document.getElementById('edit_player_name').value = name;
        document.getElementById('edit_player_position').value = position;
        document.getElementById('edit_player_team').value = team;
        document.getElementById('edit_player_goals').value = goals;
        document.getElementById('edit_player_assists').value = assists;
        document.getElementById('edit_player_matches').value = matches;
        document.getElementById('editPlayerForm').action = '/admin/player/edit/' + id;
        document.getElementById('editPlayerModal').classList.add('active');
    }

    function closeModal(modalId) {
        document.getElementById(modalId).classList.remove('active');
    }

    // Close modal when clicking outside
    window.onclick = function(event) {
        if (event.target.classList.contains('modal')) {
            event.target.classList.remove('active');
        }
    }
</script>
{% endblock %}
